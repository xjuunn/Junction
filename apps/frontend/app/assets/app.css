@import "tailwindcss";

@plugin "daisyui" {
    theme: dark --default;
}

@plugin "daisyui/theme" {
    name: "dark";
    default: true;
    prefersdark: true;
    color-scheme: "dark";
    --color-base-100: oklch(18% 0.02 260);
    --color-base-200: oklch(22% 0.02 260);
    --color-base-300: oklch(26% 0.02 260);
    --color-base-content: oklch(92% 0.01 260);
    --color-primary: oklch(65% 0.2 260);
    --color-primary-content: oklch(98% 0.01 260);
    --color-secondary: oklch(70% 0.15 320);
    --color-secondary-content: oklch(20% 0.02 320);
    --color-accent: oklch(75% 0.15 190);
    --color-accent-content: oklch(20% 0.02 190);
    --color-neutral: oklch(35% 0.03 260);
    --color-neutral-content: oklch(95% 0.01 260);
    --color-info: oklch(72% 0.13 220);
    --color-success: oklch(75% 0.16 150);
    --color-warning: oklch(80% 0.15 85);
    --color-error: oklch(65% 0.18 25);
    --radius-selector: 0.75rem;
    --radius-field: 0.75rem;
    --radius-box: 1rem;
    --size-selector: 0.25rem;
    --size-field: 0.25rem;
    --border: 1px;
    --depth: 1;
    --noise: 0.02;
}

@plugin "daisyui/theme" {
    name: "light";
    default: false;
    prefersdark: false;
    color-scheme: "light";
    --color-base-100: oklch(98% 0.005 260);
    --color-base-200: oklch(95% 0.01 260);
    --color-base-300: oklch(90% 0.01 260);
    --color-base-content: oklch(25% 0.02 260);
    --color-primary: oklch(60% 0.2 260);
    --color-primary-content: oklch(100% 0 0);
    --color-secondary: oklch(65% 0.18 320);
    --color-secondary-content: oklch(100% 0 0);
    --color-accent: oklch(60% 0.15 180);
    --color-accent-content: oklch(100% 0 0);
    --color-neutral: oklch(30% 0.03 260);
    --color-neutral-content: oklch(98% 0.01 260);
    --color-info: oklch(65% 0.15 225);
    --color-success: oklch(65% 0.18 145);
    --color-warning: oklch(75% 0.15 75);
    --color-error: oklch(60% 0.2 25);
    --radius-selector: 0.75rem;
    --radius-field: 0.75rem;
    --radius-box: 1rem;
    --size-selector: 0.25rem;
    --size-field: 0.25rem;
    --border: 1px;
    --depth: 1;
    --noise: 0;
}

@font-face {
    font-family: Modernia;
    src: url(/fonts/Modernia-Regular-2.otf) format('opentype');
    font-display: swap;
}

.font-modernia {
    font-family: Modernia, 'Courier New', Courier, monospace;
}

@font-face {
    font-family: siyuan;
    src: url(/fonts/SourceHanSansCN-VF.otf);
}

.font-siyuan {
    font-family: siyuan;
}

* {
    scrollbar-width: thin;
    scrollbar-color: rgba(100, 100, 100, 0.2) transparent;
    touch-action: pan-x pan-y;
}

body,
html {
    overflow: hidden;
    font-family: siyuan, "PingFang SC", "Microsoft YaHei", "Noto Sans CJK SC",
        "Source Han Sans SC", "Hiragino Sans GB", "Heiti SC",
        "WenQuanYi Micro Hei", sans-serif;
}

.font-sans {
    font-family: siyuan, "PingFang SC", "Microsoft YaHei", "Noto Sans CJK SC",
        "Source Han Sans SC", "Hiragino Sans GB", "Heiti SC",
        "WenQuanYi Micro Hei", sans-serif;
}

.theme-transition {
    transition: background-color 0.45s cubic-bezier(0.4, 0, 0.2, 1),
        color 0.45s cubic-bezier(0.4, 0, 0.2, 1),
        border-color 0.45s cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 0.45s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: background-color, color;
    transform: translateZ(0);
}

.theme-ripple-anime {
    position: fixed;
    pointer-events: none;
    z-index: 9999;
    mix-blend-mode: overlay;
    border-radius: 50%;
    transform: scale(0);
    opacity: 0.8;
    will-change: transform, opacity, backdrop-filter;
    overflow: hidden;
}

.page-enter-active,
.page-leave-active {
    transition: opacity 0.1s ease-in-out;
}

.page-enter-from,
.page-leave-to {
    opacity: 0;
}

.layout-enter-active,
.layout-leave-active {
    transition: all 0.1s;
}

.layout-enter-from,
.layout-leave-to {
    filter: grayscale(1);
}

/* 仅让页面容器透明，不影响表单与浮层组件 */
.mica-active .bg-base-100:not(.select):not(.input):not(.textarea):not(.dropdown-content):not(.menu):not(.modal-box):not(.popover):not(.btn),
.mica-active .bg-base-200:not(.select):not(.input):not(.textarea):not(.dropdown-content):not(.menu):not(.modal-box):not(.popover):not(.btn),
.mica-active .bg-base-300:not(.select):not(.input):not(.textarea):not(.dropdown-content):not(.menu):not(.modal-box):not(.popover):not(.btn) {
    background-color: transparent !important;
}

/* 云母模式下，浮层与表单控件必须保持可读背景，避免与内容重叠 */
.mica-active .select,
.mica-active .input,
.mica-active .textarea {
    background-color: hsl(var(--b1) / 0.82) !important;
    border-color: hsl(var(--bc) / 0.12) !important;
    backdrop-filter: blur(10px);
}

/* 针对带 bg-base-100 的表单控件做强制兜底，避免继续透明 */
.mica-active .select.bg-base-100,
.mica-active .input.bg-base-100,
.mica-active .textarea.bg-base-100,
.mica-active .select.bg-base-200,
.mica-active .input.bg-base-200,
.mica-active .textarea.bg-base-200,
.mica-active .select.bg-base-300,
.mica-active .input.bg-base-300,
.mica-active .textarea.bg-base-300 {
    background-color: hsl(var(--b1) / 0.9) !important;
}

.mica-active select option,
.mica-active select optgroup {
    background-color: hsl(var(--b1)) !important;
    color: hsl(var(--bc)) !important;
}

.mica-active .dropdown-content,
.mica-active .menu,
.mica-active .popover,
.mica-active .modal-box,
.mica-active .drawer-side > *,
.mica-active .toast > * {
    background-color: hsl(var(--b1) / 0.9) !important;
    border: 1px solid hsl(var(--bc) / 0.1);
    backdrop-filter: blur(12px);
}

/* 全局浮层磨砂兜底：不依赖 base-100，避免主题被透明化后下拉穿透 */
:root {
    --glass-surface: oklch(22% 0.02 260 / 0.88);
    --glass-border: oklch(92% 0.01 260 / 0.14);
}

[data-theme="light"] {
    --glass-surface: oklch(98% 0.005 260 / 0.82);
    --glass-border: oklch(25% 0.02 260 / 0.1);
}

/* 下拉触发按钮：统一半透明 + 模糊 */
.dropdown > .btn,
.dropdown > .btn.btn-ghost,
.dropdown > .btn.btn-soft,
.dropdown > [role="button"].btn {
    background-color: var(--glass-surface) !important;
    border-color: var(--glass-border) !important;
    backdrop-filter: blur(10px);
}

/* 下拉面板与菜单：统一半透明 + 模糊，防止与内容重叠 */
.dropdown-content,
.dropdown-content.menu,
.menu.dropdown-content {
    background-color: var(--glass-surface) !important;
    border: 1px solid var(--glass-border) !important;
    backdrop-filter: blur(14px);
    box-shadow: 0 8px 28px rgb(0 0 0 / 0.14);
}

/* 统一 main/admin 的下拉样式（触发器 + 面板 + 选项） */
.select,
.select.select-bordered {
    background-color: var(--glass-surface) !important;
    border-color: var(--glass-border) !important;
    backdrop-filter: blur(12px);
}

.select:focus,
.select:focus-visible,
.dropdown > .btn:focus,
.dropdown > .btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px hsl(var(--p) / 0.2);
}

.dropdown-content.menu li > * {
    border-radius: 0.65rem;
    background-color: transparent;
    transition: background-color 0.15s ease, color 0.15s ease;
}

.dropdown-content.menu li > *:hover,
.dropdown-content.menu li > *:focus-visible,
.dropdown-content.menu li > *.active,
.dropdown-content.menu li > *.router-link-active {
    background-color: hsl(var(--bc) / 0.1) !important;
}

/* 原生 select 的 option 由系统控件绘制，无法做真正 blur；统一底色与文本确保一致性 */
select option,
select optgroup {
    background-color: hsl(var(--b1)) !important;
    color: hsl(var(--bc)) !important;
}
