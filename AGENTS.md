# Junction AI ?????????

???????? Junction monorepo ?????? AI ???**?????????????**?

## ????

Junction ??? **pnpm workspaces** ? **TurboRepo** ? monorepo?

- ???Nuxt 4 + Vue 3 + Pinia + Tailwind + DaisyUI + Tauri
- ???NestJS + Prisma + Redis + Swagger
- ?????`@junction/types`

## ??????????

- **???????? `fetch`/`axios`**????? `apps/frontend/app/api` ???????
- **????????**?`ApiResponse`/`PaginationData`/`PrismaTypes` ???? `@junction/types` ???
- **????????**?`~/utils`?`~/composables`?`~/stores`?`~/services`?`~/api`?
- **??????**???????????

## ????????

### Settings Store
?????????? Pinia store?????????

- ???`apps/frontend/app/stores/settings.ts`
- ?????
  ```ts
  import { useSettingsStore } from '~/stores/settings'

  const settings = useSettingsStore()
  settings.downloadPath = 'D:\Downloads'
  ```
- ?????
  - `downloadPath`????????????Tauri ???
  - `themeMode`?`primaryColor`?`compactMode`
  - `sidebarCollapsed`?`animationsEnabled`?`animationSpeed`
  - `language`?`timezone`?`dateFormat`?`timeFormat`
  - `autoCheckUpdate`?`startMinimizedToTray`

> ???**???? `useAppStore` ?????**???? `useSettingsStore` ???

### ??????
?????/???????????? `useSettingsStore()` ????????????????

## ????????

### ????
???????? `apps/frontend/app/utils/download.ts`?

- ?????????
  - ??? `settings.downloadPath`
  - ????????????????
- ??? Tauri ????? `plugin-http` + `plugin-fs`?

### ????
```ts
import { downloadFile } from '~/utils/download'

await downloadFile({
  source: { url: fileUrl, name: fileName },
  target: { dir: settings.downloadPath },
})
```

### ??????
?????????????? `toast.success('????')`?  
????????????????????

## Tauri ????

### ??
????? Tauri ???
- `@tauri-apps/plugin-dialog`????**??????**?? UI ???
- `@tauri-apps/plugin-fs`
- `@tauri-apps/plugin-http`

> UI ???????????????????? Tauri Dialog ?? UI?

### ??
???????
`apps/frontend/src-tauri/capabilities/default.json`

?????
- `dialog:allow-open`
- `fs:allow-write-file`
- `fs:allow-mkdir`
- `fs:allow-exists`
- `fs:allow-download-write`
- ?? URL ????????`http://10.105.86.133:8080/**`?

## ?????

????????

- `pnpm dev` / `pnpm dev:frontend` / `pnpm dev:backend`
- `pnpm build` / `pnpm build:packages`

?????
- `pnpm test` / `pnpm test:e2e`

## ??????????

- `<script setup>` + Vue 3 Composition API
- 2 ?????????????
- ? Prettier ?????????
- ???? Nuxt ????
- UI ?????**?? `outline` ??????? `soft/ghost` ??**??? `badge-ghost`?`btn-ghost`?`bg-base-200`?????????????
- ?????????????
  - ????/???????????? `bg-base-100/200/300` ???????????????????
  - ??????????Modal/Toast/????/????/??/??????????? + ?????
    - ?? `bg-base-100/80` ? `bg-base-200/80` + `backdrop-blur-md`???? blur??
  - ???? `bg-base-100/200/300` ????????????????
- ????????????
  - ??????????????? `border-r border-base-content/5`??????????

## ??????????

- ESLint + Prettier
- ????? `HttpExceptionFilter` ??
- ???? `~` ?? `src`

---

*Last updated: February 2026*

## ???????????

### ????????
- ?????? UTF-8 ???? GBK?????????? UTF-8 ??/???
- ??????????????????? `\`???????????????????
- ?????/?????????????????????????

### ????
- **?????????? UTF-8?? BOM?**??? `.ts`?`.vue`?`.prisma`?`.md`?`.json`?
- ????????????????????????**?????? UTF-8 ??**?
- ???? `apply_patch` ????????????????
- ?????????? `?` ?????????

### ????
- IDE ???????? UTF-8????????? UTF-8 ????
- ???????????????????
  ```python
  from pathlib import Path
  path = Path('path/to/file')
  text = path.read_text(encoding='utf-8')
  # ... ?? text ...
  path.write_text(text, encoding='utf-8')
  ```
- ? `.prisma` ????????????????????? Patch ???

## AI ???????????

### ??????
- ??????????????`apps/frontend/app/utils/ai.ts`
- ????????/????`apps/frontend/app/api/ai.ts`

### ?????
- ? `apps/frontend/nuxt.config.ts` ??? `runtimeConfig.public.ai`
- `.env` / `.env.example` ?????
  - `NUXT_PUBLIC_AI_DEFAULT_PROVIDER`
  - `DEEPSEEK_API_KEY`
  - `DEEPSEEK_API_BASE_URL`
  - `DEEPSEEK_DEFAULT_MODEL`

### ???????Pinia ????
- Store?`apps/frontend/app/stores/settings.ts`
- ???
  - `aiProviderId`
  - `aiApiKey`
  - `aiBaseUrl`
  - `aiDefaultModel`
- ???**???????**???????????????

### ????????
```ts
import { generateAiText, streamAiText } from '~/api/ai'

const result = await generateAiText({
  prompt: '???????????',
  system: '???????',
})

const stream = await streamAiText({
  messages: [
    { role: 'user', content: '??????????' },
  ],
})
for await (const chunk of stream.textStream) {
  console.log(chunk)
}
```

### ??????
- ? `apps/frontend/app/utils/ai.ts` ?? `registerAiProviderFactory` ?????
- ????????? `LanguageModel`
- Deepseek ??? `openai.chat(modelId)` ????? `responses` ?? 404

### ????
- ???????? `fetch`/`axios` ?? AI?????????
- API Key ???????????????????????

## ????????????
- ?????????? `apps/frontend/app/layouts/admin.vue`??????????????
- ???????? `apps/frontend/app/pages/admin/index/**` ??????????????
- ??????????`/admin/tables/:table`??????`apps/frontend/app/pages/admin/index/tables/[table].vue`??
- ??????????????????????????
- **????? Prisma ???????????????????**?
  - ???????`apps/frontend/app/layouts/admin.vue`??
  - ???????????`apps/frontend/app/pages/admin/index/database.vue`??
  - ???????????????????????`apps/frontend/app/pages/admin/index/tables/[table].vue`??

## ?????LiveKit????

### ????
- **??????????? LiveKit**????? P2P ???
- **????????**????? LiveKit Server?
- Token ??????????????????

### ??
- Token ???`POST /call/livekit/token`
- ?????`apps/backend/src/resource/call/call.service.ts`
- ????`apps/backend/src/resource/call/call.controller.ts`

### ??
- ?????`apps/frontend/app/api/call.ts`
- ??????`apps/frontend/app/core/rtc/call-manager.ts`

### ?????.env / .env.example?
- `NUXT_PUBLIC_LIVEKIT_URL`
- `LIVEKIT_URL`
- `LIVEKIT_API_KEY`
- `LIVEKIT_API_SECRET`

### ????
- ???`infra/livekit/`
- Compose?`infra/livekit/docker-compose.yml`
- ???`infra/livekit/livekit.yaml`

### ????
- `7880`?HTTP/WebSocket?
- `7881`?TCP?
- `7882/udp`?UDP?
